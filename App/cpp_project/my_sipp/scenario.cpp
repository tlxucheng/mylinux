#include "sipp.hpp"

/* This mode setting refers to whether we open calls autonomously (MODE_CLIENT)
 * or in response to requests (MODE_SERVER). */
int           creationMode  = MODE_CLIENT;
/* Send mode. Do we send to a fixed address or to the last one we got. */
int           sendMode  = MODE_CLIENT;

/******** Global variables which compose the scenario file **********/

scenario      *main_scenario;
scenario      *ooc_scenario;
scenario      *aa_scenario;
scenario      *display_scenario;

const char *scenario_table[] = {
    "uac",
    "uas",
    "regexp",
    "3pcc-C-A",
    "3pcc-C-B",
    "3pcc-A",
    "3pcc-B",
    "branchc",
    "branchs",
    "uac_pcap",
    "ooc_default",
    "ooc_dummy",
};

int find_scenario(const char *scenario)
{
    int i, max;
    max = sizeof(scenario_table)/sizeof(scenario_table[0]);

    for (i = 0; i < max; i++) {
        if (!strcmp(scenario_table[i], scenario)) {
            return i;
        }
    }

    printf("Invalid default scenario name %s.\n", scenario);

    /* Setting the rate and its dependant params (open_calls_allowed) */
    /* If we are a client, then create the task to open new calls. */
    if (creationMode == MODE_CLIENT) {
        CallGenerationTask::initialize();
        CallGenerationTask::set_rate(rate);
    }

    return -1;
}

/********************** Scenario File analyser **********************/
scenario::scenario(char * filename, int deflt)
{
	if(filename)
	{
	    if(!xp_set_xml_buffer_from_file(filename)) 
	    {
            ERROR("Unable to load or parse '%s' xml scenario file", filename);
        }
	}
	else
	{
        if(!xp_set_xml_buffer_from_string(default_scenario[deflt]))
		{
            ERROR("Unable to load default xml scenario file");
        }
	}
}

const char * default_scenario [] = {
    /************* Default_scenario[0] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp default 'uac' scenario.                       -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"Basic Sipstone UAC\">\n"
    "  <!-- In client mode (sipp placing calls), the Call-ID MUST be         -->\n"
    "  <!-- generated by sipp. To do so, use [call_id] keyword.                -->\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag00[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 INVITE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[media_ip_type] [media_ip]\n"
    "      t=0 0\n"
    "      m=audio [media_port] RTP/AVP 0\n"
    "      a=rtpmap:0 PCMU/8000\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"100\"\n"
    "        optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"180\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"183\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- By adding rrs=\"true\" (Record Route Sets), the route sets         -->\n"
    "  <!-- are saved and used for following messages sent. Useful to test   -->\n"
    "  <!-- against stateful SIP proxies/B2BUAs.                             -->\n"
    "  <recv response=\"200\" rtd=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- Packet lost can be simulated in any send/recv message by         -->\n"
    "  <!-- by adding the 'lost = \"10\"'. Value can be [1-100] percent.       -->\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag00[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 ACK\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- This delay can be customized by the -d command-line option       -->\n"
    "  <!-- or by adding a 'milliseconds = \"value\"' option here.             -->\n"
    "  <pause/>\n"
    "\n"
    "  <!-- The 'crlf' option inserts a blank line in the statistics report. -->\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag00[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 2 BYE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"200\" crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"10, 20, 30, 40, 50, 100, 150, 200\"/>\n"
    "\n"
    "  <!-- definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"10, 50, 100, 500, 1000, 5000, 10000\"/>\n"
    "\n"
    "</scenario>\n"
    "\n"
    ,

    /************* Default_scenario[1] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp default 'uas' scenario.                       -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"Basic UAS responder\">\n"
    "  <!-- By adding rrs=\"true\" (Record Route Sets), the route sets         -->\n"
    "  <!-- are saved and used for following messages sent. Useful to test   -->\n"
    "  <!-- against stateful SIP proxies/B2BUAs.                             -->\n"
    "  <recv request=\"INVITE\" crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- The '[last_*]' keyword is replaced automatically by the          -->\n"
    "  <!-- specified header if it was present in the last message received  -->\n"
    "  <!-- (except if it was a retransmission). If the header was not       -->\n"
    "  <!-- present or if no message has been received, the '[last_*]'       -->\n"
    "  <!-- keyword is discarded, and all bytes until the end of the line    -->\n"
    "  <!-- are also discarded.                                              -->\n"
    "  <!--                                                                  -->\n"
    "  <!-- If the specified header was present several times in the         -->\n"
    "  <!-- message, all occurences are concatenated (CRLF separated)        -->\n"
    "  <!-- to be used in place of the '[last_*]' keyword.                   -->\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 180 Ringing\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag01[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag01[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[media_ip_type] [media_ip]\n"
    "      t=0 0\n"
    "      m=audio [media_port] RTP/AVP 0\n"
    "      a=rtpmap:0 PCMU/8000\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv request=\"ACK\"\n"
    "        optional=\"true\"\n"
    "        rtd=\"true\"\n"
    "        crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv request=\"BYE\">\n"
    "  </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- Keep the call open for a while in case the 200 is lost to be     -->\n"
    "  <!-- able to retransmit it if we receive the BYE again.               -->\n"
    "  <timewait milliseconds=\"4000\"/>\n"
    "\n"
    "\n"
    "  <!-- definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"10, 20, 30, 40, 50, 100, 150, 200\"/>\n"
    "\n"
    "  <!-- definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"10, 50, 100, 500, 1000, 5000, 10000\"/>\n"
    "\n"
    "</scenario>\n"
    "\n",

    /************* Default_scenario[2] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp default 'regexp client' scenario.             -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"Client with regexp scenario\">\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag02[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 INVITE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[media_ip_type] [media_ip]\n"
    "      t=0 0\n"
    "      m=audio [media_port] RTP/AVP 0\n"
    "      a=rtpmap:0 PCMU/8000\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"100\"\n"
    "        optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"180\" optional=\"true\">\n"
    "  </recv>\n"
    "  <recv response=\"183\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"200\" start_rtd=\"true\">\n"
    "    <!-- Definition of regexp in the action tag. The regexp must follow -->\n"
    "    <!-- the Posix Extended standard (POSIX 1003.2), see:               -->\n"
    "    <!--                                                                -->\n"
    "    <!--   http://www.opengroup.org/onlinepubs/007908799/xbd/re.html    -->\n"
    "    <!--                                                                -->\n"
    "    <!-- regexp    : Contain the regexp to use for matching the         -->\n"
    "    <!--             received message                                   -->\n"
    "    <!--             MANDATORY                                          -->\n"
    "    <!-- search_in : msg (try to match against the entire message)      -->\n"
    "    <!--           : hdr (try to match against a specific SIP header    -->\n"
    "    <!--             (passed in the header tag)                         -->\n"
    "    <!--             OPTIONAL - default value : msg                     -->\n"
    "    <!-- header    : Header to try to match against.                    -->\n"
    "    <!--             Only used when the search_in tag is set to hdr     -->\n"
    "    <!--             MANDATORY IF search_in is equal to hdr             -->\n"
    "    <!-- check_it  : if set to true, the call is marked as failed if    -->\n"
    "    <!--             the regexp doesn't match.                          -->\n"
    "    <!--             OPTIONAL - default value : false                   -->\n"
    "    <!-- assign_to : contain the variable id (integer) or a list of     -->\n"
    "    <!--             variable id which will be used to store the        -->\n"
    "    <!--             result of the matching process between the regexp  -->\n"
    "    <!--             and the message. This variable can be re-used at   -->\n"
    "    <!--             a later time in the scenario using '[$n]' syntax   -->\n"
    "    <!--             where n is the variable id.                        -->\n"
    "    <!--             MANDATORY                                          -->\n"
    "    <action>\n"
    "      <ereg regexp=\"[0-9]{1,3}[.][0-9]{1,3}[.][0-9]{1,3}[.][0-9]{1,3}[:][0-9]{1,5}\" \n"
    "            search_in=\"msg\" \n"
    "            check_it=\"true\" \n"
    "            assign_to=\"1\"/>\n"
    "      <ereg regexp=\".*\" \n"
    "            search_in=\"hdr\" \n"
    "            header=\"Contact:\" \n"
    "            check_it=\"true\" \n"
    "            assign_to=\"6\"/>\n"
    "      <ereg regexp=\"o=([[:alnum:]]*) ([[:alnum:]]*) ([[:alnum:]]*)\"\n"
    "            search_in=\"msg\" \n"
    "            check_it=\"true\" \n"
    "            assign_to=\"3,4,5,8\"/>\n"
    "    </action>\n"
    "  </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag02[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 ACK\n"
    "      retrievedIp: [$1]\n"
    "      retrievedContact:[$6]\n"
    "      retrievedSdpOrigin:[$3]\n"
    "      retrievedSdpOrigin-username:[$4]\n"
    "      retrievedSdpOrigin-session-id:[$5]\n"
    "      retrievedSdpOrigin-version:[$8]\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- This delay can be customized by the -d command-line option       -->\n"
    "  <!-- or by adding a 'milliseconds = \"value\"' option here.           -->\n"
    "  <pause milliseconds = \"1000\"/>\n"
    "\n"
    "  <!-- The 'crlf' option inserts a blank line in the statistics report. -->\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag02[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 2 BYE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"200\" crlf=\"true\" rtd=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"1000, 1040, 1080, 1120, 1160, 1200\"/>\n"
    "\n"
    "  <!-- definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"1000, 1100, 1200, 1300, 1400\"/>\n"
    "\n"
    "</scenario>\n"
    "\n",

    /************* Default_scenario[3] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 3PCC - Controller - A side                         -->\n"
    "<!--                                                                    -->\n"
    "<!--             A              Controller               B              -->\n"
    "<!--             |(1) INVITE no SDP  |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(2) 200 offer1     |                   |              -->\n"
    "<!--             |==================>|                   |              -->\n"
    "<!--             |                   |(3) INVITE offer1  |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |                   |(4) 200 OK answer1 |              -->\n"
    "<!--             |                   |<==================|              -->\n"
    "<!--             |                   |(5) ACK            |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |(6) ACK answer1    |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(7) RTP            |                   |              -->\n"
    "<!--             |.......................................|              -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"3PCC Controller - A side\">\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag03[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 INVITE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"100\" optional=\"true\"> </recv>\n"
    "  <recv response=\"180\" optional=\"true\"> </recv>\n"
    "  <recv response=\"183\" optional=\"true\"> </recv>\n"
    "  <recv response=\"200\" crlf=\"true\" start_rtd=\"true\">\n"
    "    <action>\n"
    "       <ereg regexp=\"Content-Type:.*\" \n"
    "             search_in=\"msg\"  \n"
    "             assign_to=\"1\" /> \n"
    "    </action>\n"
    "  </recv>\n"
    "\n"
    "  <sendCmd>\n"
    "    <![CDATA[\n"
    "      Call-ID: [call_id]\n"
    "      [$1]\n"
    "\n"
    "     ]]>\n"
    "  </sendCmd>\n"
    "  \n"
    "  <recvCmd>\n"
    "    <action>\n"
    "       <ereg regexp=\"Content-Type:.*\"  \n"
    "             search_in=\"msg\"  \n"
    "             assign_to=\"2\" /> \n"
    "    </action>\n"
    "  \n"
    "  </recvCmd>\n"
    "  \n"
    "  <send rtd=\"true\">\n"
    "    <![CDATA[\n"
    "\n"
    "      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag03[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 ACK\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      [$2]\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <pause milliseconds=\"1000\"/>\n"
    "\n"
    "  <!-- The 'crlf' option inserts a blank line in the statistics report. -->\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag03[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 2 BYE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"200\" crlf=\"true\"> </recv>\n"
    "\n"
    "</scenario>\n"
    "\n",

    /************* Default_scenario[4] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 3PCC - Controller - B side                         -->\n"
    "<!--                                                                    -->\n"
    "<!--             A              Controller               B              -->\n"
    "<!--             |(1) INVITE no SDP  |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(2) 200 offer1     |                   |              -->\n"
    "<!--             |==================>|                   |              -->\n"
    "<!--             |                   |(3) INVITE offer1  |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |                   |(4) 200 OK answer1 |              -->\n"
    "<!--             |                   |<==================|              -->\n"
    "<!--             |                   |(5) ACK            |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |(6) ACK answer1    |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(7) RTP            |                   |              -->\n"
    "<!--             |.......................................|              -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "\n"
    "<scenario name=\"3PCC Controller - B side\">\n"
    "\n"
    "<recvCmd>\n"
    "  <action>\n"
    "       <ereg regexp=\"Content-Type:.*\"  \n"
    "             search_in=\"msg\"  \n"
    "             assign_to=\"1\" /> \n"
    "  </action>\n"
    "</recvCmd>\n"
    "\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag04[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 INVITE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      [$1]\n"
    "\n"
    "     ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"100\" optional=\"true\"> </recv>\n"
    "  <recv response=\"180\" optional=\"true\"> </recv>\n"
    "  <recv response=\"183\" optional=\"true\"> </recv>\n"
    "  <recv response=\"200\" crlf=\"true\">\n"
    "    <action>\n"
    "       <ereg regexp=\"Content-Type:.*\"  \n"
    "             search_in=\"msg\"  \n"
    "             assign_to=\"2\" /> \n"
    "    </action>\n"
    "  </recv>\n"
    "  \n"
    "    \n"
    "  <send start_rtd=\"true\">\n"
    "    <![CDATA[\n"
    "\n"
    "      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag04[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 ACK\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <sendCmd>\n"
    "    <![CDATA[\n"
    "      Call-ID: [call_id]\n"
    "      [$2]\n"
    "\n"
    "    ]]>\n"
    "  </sendCmd>\n"
    " \n"
    "  <pause milliseconds=\"1000\"/>\n"
    "\n"
    "\n"
    "  <!-- The 'crlf' option inserts a blank line in the statistics report. -->\n"
    "  <send retrans=\"500\" rtd=\"true\">\n"
    "    <![CDATA[\n"
    "\n"
    "      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag04[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 2 BYE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"200\" crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "\n"
    "</scenario>\n"
    "\n",

    /************* Default_scenario[5] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 3PCC - A side emulator                             -->\n"
    "<!--                                                                    -->\n"
    "<!--             A              Controller               B              -->\n"
    "<!--             |(1) INVITE no SDP  |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(2) 200 offer1     |                   |              -->\n"
    "<!--             |==================>|                   |              -->\n"
    "<!--             |                   |(3) INVITE offer1  |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |                   |(4) 200 OK answer1 |              -->\n"
    "<!--             |                   |<==================|              -->\n"
    "<!--             |                   |(5) ACK            |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |(6) ACK answer1    |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(7) RTP            |                   |              -->\n"
    "<!--             |.......................................|              -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "\n"
    "<scenario name=\"3PCC A side\">\n"
    "  <recv request=\"INVITE\" crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag05[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[media_ip_type] [media_ip]\n"
    "      t=0 0\n"
    "      m=audio [media_port] RTP/AVP 0\n"
    "      a=rtpmap:0 PCMU/8000\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv request=\"ACK\" rtd=\"true\" crlf=\"true\"> </recv>\n"
    "\n"
    "  <!-- RTP flow starts from here! -->\n"
    "\n"
    "  <recv request=\"BYE\" crlf=\"true\"> </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- Keep the call open for a while in case the 200 is lost to be     -->\n"
    "  <!-- able to retransmit it if we receive the BYE again.               -->\n"
    "  <timewait milliseconds=\"2000\"/>\n"
    "\n"
    "</scenario>\n"
    "\n",

    /************* Default_scenario[6] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 3PCC - B side emulator                             -->\n"
    "<!--                                                                    -->\n"
    "<!--             A              Controller               B              -->\n"
    "<!--             |(1) INVITE no SDP  |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(2) 200 offer1     |                   |              -->\n"
    "<!--             |==================>|                   |              -->\n"
    "<!--             |                   |(3) INVITE offer1  |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |                   |(4) 200 OK answer1 |              -->\n"
    "<!--             |                   |<==================|              -->\n"
    "<!--             |                   |(5) ACK            |              -->\n"
    "<!--             |                   |==================>|              -->\n"
    "<!--             |(6) ACK answer1    |                   |              -->\n"
    "<!--             |<==================|                   |              -->\n"
    "<!--             |(7) RTP            |                   |              -->\n"
    "<!--             |.......................................|              -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "\n"
    "\n"
    "<scenario name=\"3PCC B side\">\n"
    "  <recv request=\"INVITE\" crlf=\"true\"> </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag06[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[media_ip_type] [media_ip]\n"
    "      t=0 0\n"
    "      m=audio [media_port] RTP/AVP 0\n"
    "      a=rtpmap:0 PCMU/8000\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv request=\"ACK\" rtd=\"true\" crlf=\"true\"> </recv>\n"
    "\n"
    "  <!-- RTP flow starts from here! -->\n"
    "\n"
    "  <recv request=\"BYE\"> </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- Keep the call open for a while in case the 200 is lost to be     -->\n"
    "  <!-- able to retransmit it if we receive the BYE again.               -->\n"
    "  <timewait milliseconds=\"2000\"/>\n"
    "\n"
    "</scenario>\n",

    /************* Default_scenario[7] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp default 'branchc' scenario.                   -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"branch_client\">\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      REGISTER sip:CA.cym.com SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: ua1 <sip:ua1@nnl.cym:[local_port]>;tag=[pid]SIPpTag07[call_number]\n"
    "      To: ua1 <sip:ua1@nnl.cym:[local_port]>\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 REGISTER\n"
    "      Contact: sip:ua1@[local_ip]:[local_port]\n"
    "      Content-Length: 0\n"
    "      Expires: 300\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- simple case - just jump over a line   -->\n"
    "  <recv response=\"200\" rtd=\"true\" next=\"5\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"200\">\n"
    "  </recv>\n"
    "\n"
    "  <label id=\"5\"/>\n"
    "\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      INVITE sip:ua2@CA.cym.com SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: ua[call_number] <sip:ua1@nnl.cym:[local_port]>;tag=[pid]SIPpTag07b[call_number]\n"
    "      To: ua2 <sip:ua2@nnl.cym:[remote_port]>\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 INVITE\n"
    "      Contact: sip:ua1@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[media_ip_type] [media_ip]\n"
    "      t=0 0\n"
    "      m=audio [media_port] RTP/AVP 0\n"
    "      a=rtpmap:0 PCMU/8000\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"100\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"180\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"183\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- Do something different on an optional receive   -->\n"
    "  <recv response=\"403\" optional=\"true\" next=\"1\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"200\">\n"
    "    <action>\n"
    "      <ereg regexp=\"ua25\"\n"
    "            search_in=\"hdr\"\n"
    "            header=\"From: \"\n"
    "            assign_to=\"8\"/>\n"
    "    </action>\n"
    "  </recv>\n"
    "\n"
    "  <!-- set variable 8 above on 25th call, send the ACK but skip the pause for it   -->\n"
    "  <send next=\"1\" test=\"8\">\n"
    "    <![CDATA[\n"
    "\n"
    "      ACK sip:ua2@CA.cym.com SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: ua1 <sip:ua1@nnl.cym:[local_port]>;tag=[pid]SIPpTag07b[call_number]\n"
    "      To: ua2 <sip:ua2@nnl.cym:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 ACK\n"
    "      Contact: sip:ua1@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <pause milliseconds=\"5000\"/>\n"
    "\n"
    "  <label id=\"1\"/>\n"
    "\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      BYE sip:ua2@CA.cym.com SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: ua1 <sip:ua1@nnl.cym:[local_port]>;tag=[pid]SIPpTag07b[call_number]\n"
    "      To: ua2 <sip:ua2@nnl.cym:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 2 BYE\n"
    "      Contact: sip:ua1@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"200\" crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <pause milliseconds=\"4000\"/>\n"
    "\n"
    "  <!-- definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"10, 20, 30, 40, 50, 100, 150, 200\"/>\n"
    "\n"
    "  <!-- definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"10, 50, 100, 500, 1000, 5000, 10000\"/>\n"
    "\n"
    "</scenario>\n"
    "\n",

    /************* Default_scenario[8] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp default 'branchs' scenario.                   -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"branch_server\">\n"
    "  <recv request=\"REGISTER\">\n"
    "  </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag08[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "      Expires: 300\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- Set variable 3 if the ua is of the form ua2... -->\n"
    "  <recv request=\"INVITE\" crlf=\"true\">\n"
    "    <action>\n"
    "      <ereg regexp=\"ua2\"\n"
    "            search_in=\"hdr\"\n"
    "            header=\"From: \"\n"
    "            assign_to=\"3\"/>\n"
    "    </action>\n"
    "  </recv>\n"
    "\n"
    "  <!-- send 180 then trying if variable 3 is set -->\n"
    "  <send next=\"1\" test=\"3\">\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 180 Ringing\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag08b[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- if not, send a 403 error then skip to wait for a BYE -->\n"
    "  <send next=\"2\">\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 403 Error\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag08b[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <label id=\"1\"/>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 100 Trying\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag08b[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:];tag=[pid]SIPpTag08b[call_number]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[media_ip_type] [media_ip]\n"
    "      t=0 0\n"
    "      m=audio [media_port] RTP/AVP 0\n"
    "      a=rtpmap:0 PCMU/8000\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv request=\"ACK\"\n"
    "        optional=\"true\"\n"
    "        rtd=\"true\"\n"
    "        crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <label id=\"2\"/>\n"
    "\n"
    "  <recv request=\"BYE\">\n"
    "  </recv>\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- Keep the call open for a while in case the 200 is lost to be     -->\n"
    "  <!-- able to retransmit it if we receive the BYE again.               -->\n"
    "  <timewait milliseconds=\"4000\"/>\n"
    "\n"
    "  <!-- Definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"10, 20, 30, 40, 50, 100, 150, 200\"/>\n"
    "\n"
    "  <!-- Definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"10, 50, 100, 500, 1000, 5000, 10000\"/>\n"
    "\n"
    "</scenario>\n"
    "\n",

    /* Although this scenario will not work without pcap play enabled, there is no
     * harm in including it in the binary anyway, because the user could have
     * dumped it and passed it with -sf. */

    /************* Default_scenario[9] ***************/
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp 'uac' scenario with pcap (rtp) play           -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"UAC with media\">\n"
    "  <!-- In client mode (sipp placing calls), the Call-ID MUST be         -->\n"
    "  <!-- generated by sipp. To do so, use [call_id] keyword.                -->\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag09[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 INVITE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Type: application/sdp\n"
    "      Content-Length: [len]\n"
    "\n"
    "      v=0\n"
    "      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]\n"
    "      s=-\n"
    "      c=IN IP[local_ip_type] [local_ip]\n"
    "      t=0 0\n"
    "      m=audio [auto_media_port] RTP/AVP 8 101\n"
    "      a=rtpmap:8 PCMA/8000\n"
    "      a=rtpmap:101 telephone-event/8000\n"
    "      a=fmtp:101 0-11,16\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"100\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <recv response=\"180\" optional=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- By adding rrs=\"true\" (Record Route Sets), the route sets         -->\n"
    "  <!-- are saved and used for following messages sent. Useful to test   -->\n"
    "  <!-- against stateful SIP proxies/B2BUAs.                             -->\n"
    "  <recv response=\"200\" rtd=\"true\" crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- Packet lost can be simulated in any send/recv message by         -->\n"
    "  <!-- by adding the 'lost = \"10\"'. Value can be [1-100] percent.       -->\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "\n"
    "      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag09[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 1 ACK\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- Play a pre-recorded PCAP file (RTP stream)                       -->\n"
    "  <nop>\n"
    "    <action>\n"
    "      <exec play_pcap_audio=\"pcap/g711a.pcap\"/>\n"
    "    </action>\n"
    "  </nop>\n"
    "\n"
    "  <!-- Pause 8 seconds, which is approximately the duration of the      -->\n"
    "  <!-- PCAP file                                                        -->\n"
    "  <pause milliseconds=\"8000\"/>\n"
    "\n"
    "  <!-- Play an out of band DTMF '1'                                     -->\n"
    "  <nop>\n"
    "    <action>\n"
    "      <exec play_pcap_audio=\"pcap/dtmf_2833_1.pcap\"/>\n"
    "    </action>\n"
    "  </nop>\n"
    "\n"
    "  <pause milliseconds=\"1000\"/>\n"
    "\n"
    "  <!-- The 'crlf' option inserts a blank line in the statistics report. -->\n"
    "  <send retrans=\"500\">\n"
    "    <![CDATA[\n"
    "\n"
    "      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0\n"
    "      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]\n"
    "      From: sipp <sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag09[call_number]\n"
    "      To: [service] <sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]\n"
    "      Call-ID: [call_id]\n"
    "      CSeq: 2 BYE\n"
    "      Contact: sip:sipp@[local_ip]:[local_port]\n"
    "      Max-Forwards: 70\n"
    "      Subject: Performance Test\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <recv response=\"200\" crlf=\"true\">\n"
    "  </recv>\n"
    "\n"
    "  <!-- definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"10, 20, 30, 40, 50, 100, 150, 200\"/>\n"
    "\n"
    "  <!-- definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"10, 50, 100, 500, 1000, 5000, 10000\"/>\n"
    "\n"
    "</scenario>\n"
    "\n",
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp default 'uas' scenario.                       -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"Out-of-call UAS\">\n"
    "  <recv request=\".*\" regexp_match=\"true\" />\n"
    "\n"
    "  <send>\n"
    "    <![CDATA[\n"
    "      SIP/2.0 200 OK\n"
    "      [last_Via:]\n"
    "      [last_From:]\n"
    "      [last_To:]\n"
    "      [last_Call-ID:]\n"
    "      [last_CSeq:]\n"
    "      Contact: <sip:[local_ip]:[local_port];transport=[transport]>\n"
    "      Content-Length: 0\n"
    "\n"
    "    ]]>\n"
    "  </send>\n"
    "\n"
    "  <!-- Keep the call open for a while in case the 200 is lost to be     -->\n"
    "  <!-- able to retransmit it if we receive the BYE again.               -->\n"
    "  <timewait milliseconds=\"4000\"/>\n"
    "\n"
    "\n"
    "  <!-- definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"10, 20, 30, 40, 50, 100, 150, 200\"/>\n"
    "\n"
    "  <!-- definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"10, 50, 100, 500, 1000, 5000, 10000\"/>\n"
    "\n"
    "</scenario>\n",
    "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n"
    "<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n"
    "\n"
    "<!-- This program is free software; you can redistribute it and/or      -->\n"
    "<!-- modify it under the terms of the GNU General Public License as     -->\n"
    "<!-- published by the Free Software Foundation; either version 2 of the -->\n"
    "<!-- License, or (at your option) any later version.                    -->\n"
    "<!--                                                                    -->\n"
    "<!-- This program is distributed in the hope that it will be useful,    -->\n"
    "<!-- but WITHOUT ANY WARRANTY; without even the implied warranty of     -->\n"
    "<!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      -->\n"
    "<!-- GNU General Public License for more details.                       -->\n"
    "<!--                                                                    -->\n"
    "<!-- You should have received a copy of the GNU General Public License  -->\n"
    "<!-- along with this program; if not, write to the                      -->\n"
    "<!-- Free Software Foundation, Inc.,                                    -->\n"
    "<!-- 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA             -->\n"
    "<!--                                                                    -->\n"
    "<!--                 Sipp default 'uas' scenario.                       -->\n"
    "<!--                                                                    -->\n"
    "\n"
    "<scenario name=\"Out-of-call UAS\">\n"
    "  <recv request=\"DUMMY\" />\n"
    "\n"
    "  <!-- definition of the response time repartition table (unit is ms)   -->\n"
    "  <ResponseTimeRepartition value=\"10, 20, 30, 40, 50, 100, 150, 200\"/>\n"
    "\n"
    "  <!-- definition of the call length repartition table (unit is ms)     -->\n"
    "  <CallLengthRepartition value=\"10, 50, 100, 500, 1000, 5000, 10000\"/>\n"
    "\n"
    "</scenario>\n",


};


